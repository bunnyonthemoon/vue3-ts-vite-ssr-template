# Руководство по разработке

## Используемые библиотеки и фреймворки

### Фреймворки и основопологающие библиотеки

-   Vue 3 https://vuejs.org
-   Typescript 4.7 https://www.typescriptlang.org/docs/
-   vite-ssr https://github.com/frandiox/vite-ssr
-   Express https://expressjs.com
-   Graphql https://graphql.org

### Препроцессоры

-   Pug https://pugjs.org/api/getting-started.html
-   Sass https://sass-lang.com

### Плагины

-   Pinia 2 https://pinia.vuejs.org
-   Vue Router 4 https://router.vuejs.org
-   VueUse https://vueuse.org
-   graphql-request https://github.com/prisma-labs/graphql-request

### Библиотеки для разработки

-   Vite 2.9 https://vitejs.dev
-   Prettier 2.5 https://prettier.io/docs/en/install.html
-   ESLint 8.5 https://eslint.org
-   pm2 https://pm2.io

## Структура проекта

-   core - основа проекта, содержит корневые файлы проекта
-   pages - страницы сайта и их уникальные компоненты
-   components - переиспользуемые или глобальные компоненты
-   layouts - лэйауты для разных типов страниц
-   server - серверная часть проекта. По большей части она просто создаёт простенький сервис, который фозвращает сбилженный проект на любой url
-   rotuer - роутинг проекта. Сама инициализация роутера происходит через vite-ssr в /core/main.ts, эта папка лишь возвращает роуты
-   stores - глобальные store проекта
-   api - graphql запросы обёрнутые в класс ApiQuery из /api/setup.ts, где описываются передаваемые переменные и получаемый ответ
-   styles - глобальные стили, миксины и переменные sass
-   assets - используемые ассеты
    -   fonts - шрифты
    -   images - картинки
    -   icons - иконки используемые через /components/TheIcon.vue
-   utils - используемые в проекте универсальные функции / утилиты
-   interfaces - используемые во всём проекте интерфейсы и типы
-   env.ts - enviroment переменные

## Правила разработки!!!!!

-   Всегда использовать scoped стили (!!!!!!!!!!!!!!!!!!!!!!!!)
-   Стараться всегда использовать typescript
-   Стараться всегда использовать препроцессоры, которые используются по всему проекту. В данном случае pug и sass
-   Желательно работать через Composition API (`<script lang="ts" setup></script>`)
-   Стараться дробить компоненты, чтобы они сильно не разрастались

## SSR

-   SSR в проекте реализован через библиотеку vite-ssr https://github.com/frandiox/vite-ssr
-   Для того, чтобы сохранить переменные компонента при предзагрузке компонента используйте initialState в функции useContext(). Подробнее читайте в документации
-   Состояние pinia автоматически сохраняется
-   Для того чтобы отрендерить элемент только на клиентской части используйте компонент clientOnly
-   Для того чтобы узнать где сейчас воспроизводится код, на сервере или клиенте используйте import.meta.env.SSR. Если true - значит сейчас воспроизводится на сервере, если нет - на клиенте
-   Для того, чтобы подробней разобраться, опять же - почитайте документацию https://github.com/frandiox/vite-ssr

## Иконки

-   Крайне рекомендуется использовать иконки через компонент /components/TheIcon.vue. В prop name передаётся название иконки. Работает валидация и автодополнение через typescipt
-   У иконок можно легко менять разные свойства через css:
    -   Чтобы поменять цвет для всей иконки используйте `color: hex или rgb или любая другая цветовая кодировка`
    -   Чтобы поменять размер для всей иконки используйте `font-size: например 14px или 19pt или 2rem или любое другое обозначение размера шрифта`
    -   Чтобы поменять stroke-width для всей иконки используйте `stroke-width: 2 или 10`
    -   Для более тонкой конфигурации иконки через css используйте в элементе иконки директиву `:deep()` после которой вы сможете настроить все внутренние элементы. Например:
        ```css
          .icon
            &:deep()
              path.some-class
                stroke: #777
        ```
-   Для добавления новой иконки нужно:
    -   Добавить svg файл в папку /assets/icons. Желательно кинуть его в одну из подпапок
    -   В svg файле желательно убрать width и height у родительского компонента и удалить свойства fill и stroke у элементов которые должны будут менять цвет
    -   Если у иконки нет fill, и она полностью контролируется через stroke, то укажите для родительского svg элемента класс `.stroke`
    -   В файл /assets/icons/index.ts добавить иконку, указав для неё уникальное название и динамически импортировав её (конструкция `() => import('./подпапка/название_файла.svg?raw')`)
    -   Всё, теперь иконку можно отобразить через TheIcon, причём название иконки будет добавлено в автодополнение
